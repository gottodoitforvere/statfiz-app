# Инструкция по работе с демонстрацией

## Быстрый старт
- Запустите `app.py`. Приложение открывается во весь экран; переключение языка доступно из главного меню.
- На главном экране выберите «Демонстрация». Верхняя часть окна — сама симуляция, нижняя разбита на панель параметров (слева) и панель измерений (справа).

## Поле симуляции
- Частицы движутся в прямоугольнике от красной (горячей) левой стены к синей (холодной) правой. Столкновения реализованы как упругие: частицы больше не «проскакивают» друг сквозь друга и не расходятся до касания.
- Цвет частицы кодирует её скорость: от синего (медленно) к красному (быстро). Меченые частицы теперь коричневые, чтобы их было видно и на ярких проекторах. При затенении фоновых частиц используется светло‑серый цвет, поэтому метки и траектория всегда контрастные.

## Панель параметров
- **Слайдеры температуры** меняют температуры левой и правой стен. При равных значениях тепловой поток должен флуктуировать около нуля.
- **Размер частиц** влияет и на рендер, и на радиус столкновений.
- **Скорость симуляции** управляет количеством шагов интегратора за кадр (0.2–6×).
- **Меченые частицы** определяет, сколько новых коричневых частиц добавится при нажатии кнопки «Добавить частицы».
- После изменения слайдеров нажмите «Применить», чтобы передать параметры в симуляцию.

## Кнопки под слайдерами
1. **Добавить частицы** — помещает выбранное количество меченых частиц в центр ячейки. Они попадают в список отслеживания и учитываются в счётчиках касаний стен.
2. **Применить** — обновляет температуру, размер частиц и скорость моделирования.
3. **Затусклить фон / Вернуть цвета** — помогает сосредоточиться на меченых частицах. В режиме затенения все немеченые частицы становятся светло‑серыми.
4. **Показать/Скрыть след** — включает траекторию для первой меченой частицы. При отсутствии меток след автоматически очищается, поэтому видимых «фантомов» больше не остаётся.
5. **Сброс измерений** — очищает счётчики касаний стен, историю теплового потока, текущий график и накопленный тепловой баланс. Кнопка удобна, когда нужно начать новый эксперимент, не перезапуская приложение.
6. **Главное меню** — возвращает на стартовый экран.

## Панель измерений
- Верхняя строка показывает накопленный тепловой баланс через центральную плоскость `Q = ∫ J dt` в единицах Дж/м². Когда слева летят более горячие частицы, значение растёт, а при преобладании правой стены — уменьшается.
- Вторая строка выводит приращение `ΔQ` за последний кадр, чтобы было видно, в какую сторону сейчас движется энергия.
- График визуализирует накопленный сигнал `Q(t)`. При равных температурах стен линия колеблется около нуля, при градиенте — устойчиво растёт или падает. Подпись «Диапазон по оси» показывает текущие пределы шкалы (Дж/м²).
- Если данных ещё нет, панель выводит подсказку «Недостаточно данных для графика».

## Добавление и отслеживание меченых частиц
- После нажатия «Добавить частицы» коричневые меченые частицы появляются в центре. Их начальные скорости выбираются из максвелловского распределения, поэтому часть частиц полетит влево, часть вправо — дальнейшее поведение определяется столкновениями и градиентом температур.
- В правом верхнем углу симуляции отображаются счётчики касаний левой и правой стен мечеными частицами. Это позволяет оценивать направление переноса энергии.
- Включите кнопку «Показать след», чтобы наблюдать траекторию первой меченой частицы. След стирается, когда частицы удалены (или после «Сброса измерений»), чтобы не оставалось «невидимых» препятствий.

## Работа с измерениями
1. Настройте нужный перепад температур и дождитесь выхода на стационарный режим (график перестанет дрейфовать).
2. Нажмите «Сброс измерений», чтобы заново обнулить счётчики и историю потока.
3. Добавьте меченые частицы и включите след, если требуется наблюдать конкретную траекторию.
4. Используйте график и шкалу для количественной оценки потока. При равных температурах шум графика должен оставаться вблизи нуля; при увеличении разности стен — линия будет устойчиво расти (тепло слева направо) или падать.

## Частые вопросы
- **Почему график иногда идёт «лесенкой»?** Мы отображаем интеграл от потока, поэтому каждая ступень соответствует суммарной энергии, пролетевшей через среднюю плоскость за кадр. Если освежить эксперимент, нажмите «Сброс измерений», чтобы начать интегрирование заново.
- **Что делать, если след остаётся после удаления меченых частиц?** В новой версии след очищается автоматически, как только меченых частиц не осталось или вы нажимаете «Сброс измерений».
- **Почему некоторые новые частицы летят «не туда»?** Начальное распределение скоростей изотропно, а направленный перенос формируется уже после нескольких столкновений. Чтобы начать замер с нуля, используйте кнопку сброса и ориентируйтесь на счётчики касаний стен и знак потока.
